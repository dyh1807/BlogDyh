---
title: Computer-Network-Midterm
date: 2023-04-25 12:08:05
tags:
- Networks
- Revision
---

> 对上半学期计算机网络所学做一个回顾

## 电路交换：  
1. 建立连接
2. 会话
3. 释放连接

## 分组交换：  
发送端：划分数据段，增加首部，构成分组packet  
中间节点：存储转发逐跳转发  
接收端：剥去首部，恢复报文

带宽：数字信道“最高数据率”  
吞吐量：实际体验

网络协议三要素：语法（结构）、语义（解释）、同步（顺序）

多路复用：发送端多个高层会话复用同一条物理链路。

## 香农公式  
$$
C=W\log_{2}\left(1+S/N\right)
$$
> S/N 也可能用分贝作为表示。
> 10db 对应 S/N = 10, 30db 对应 S/N = 1000
> 分贝 $L = 10\log_{10}{S/N}$

## 差错检测  
基本方法：引入“冗余”，使得被传输的帧具备某种性质；接收方检测接收到的帧是否仍然具有这一性质。  
CRC校验：计算方法是非标准的多项式除法，不能简单使用带余除法。

## 检错、纠错选择
纠错往往需要比检错更多的冗余码。选择纠错一般应用于检错重传代价非常高的场景：   
1. 重传代价高  
2. 出现错误概率高  
3. 无法进行重传  
这三种情形本质都是重传代价高。  

## 可靠传输  
所谓“可靠”，指的是确保发出去的数据一定被接收方接收到。  
基本原理：确认+超时  
两种方法：  
1. stop-and-wait
2. sliding-window

### 滑动窗口算法（sliding-window）  
发送方：维护不超过SWS的窗口， 窗口介于LAR和LFS之间。  
每次收到一个Ack后，若窗口允许就发送新的帧，并更新LFS。  
SWS的本质含义是可以缓存（以备重传的需要）的帧的数量。  

接收方：维护一个LFR（最后接收确认的帧的编号）和一个LAF（最大的可接受的帧的序号）。  
需要做的操作是在接收到帧之后恢复最大连续数据帧的SeqNum。
RWS表示：接收方允许接收的帧的范围。
> LAF ?= LFR+RWS ？？？

## 媒体共享技术
包括静态信道划分和动态接入控制。

### 静态划分
包括：时分、频分、波分、码分复用。  
主要关注码分复用是实现：构造点乘正交。

码分复用：每个比特被划分为不同时间段上的组合。

### 动态接入控制

ALHOA
CSMA/CD
CSMA/CA

## 交换网络

### 网桥

数据链路层扩大LAN。

网桥隔离了不同的碰撞域。

简而言之，“两个端口的二层交换机”。

### 生成树协议

逻辑上消除网络拓扑中的冗余链路。

### VLAN

Virtual LAN，由一些局域网网段构成的与物理位置无关的逻辑组。

## 网络互联

> 网络层内容。连接各式各样的网络，构成互联网。

### IP设计

1. 无连接(类似分组交换)
2. 最大努力交付（不负责可靠传输，可靠传输由其他层实现）

> 虚电路：曾经可能的网络层技术，曾经和IP竞争

### 网络层互联结点

被称为路由器/网关。

### IP相关协议
路由选择协议(RIP、OSPF、BGP)  
ARP  
ICMP  
IGMP

### ipv4分类
A、B、C类网络  


### 路由器转发表
FIB表，存放：net_id - next_hop(next ip) 关系。

若找到了FIB表中对应项，选择对应项进行转发；否则选择默认路由。

### ARP
向每一条目的ip转发时，每一个结点需要根据本次传输的目的结点IP找到对应的目的结点的硬件地址，做出封装之后才能转发。

查找目标（下一跳）MAC：先看本地的ARP缓存，若没有则广播查找。反馈时，单播反馈。

### IP头
采用了checksum校验和（置为全0检验）

### IP分片（Fragmentation）
分组经历网络的MTU比分组长度小，路由器把该分组分成小的数据块（称为分片，fragment）后放进物理帧

特点：分片长度（字节长度）必须时8的倍数。

### 划分子网

IP地址变为3级：网络号、子网号、主机号。

划分子网纯属一个机构内部的事情，对外仍表现为未划分子网的网络。因此，到同一组子网肯定要先到同一个路由器。

为了区分子网，路由器应该识别出子网的网络号，这需要通过子网掩码和ip地址逐位做与操作，获得子网的网络号。

未划分子网的网络也使用子网掩码（默认子网掩码）

划分子网借位规则：至少2位，至少为主机号留2位。

为了识别子网，FIB表中应该增加一项子网掩码。


### 聚合超网

无分类域间路由 CIDR

查找路由表时，采用最长前缀匹配。

### ICMP
ICMP, Internet Control Message Protocol  
用于网络诊断和控制：主机或路由器用于报告错误、异常情况。

### 路由和转发

转发：接收分组，查询目标地址，根据转发表转发

路由：根据路由算法建立路由表的过程，而路由表是转发表的前身。

### IP路由协议
RIP、OSPF、BGP

### 自治系统

AS， 使用同一种自制协议的、通过单一技术管理的系统，由众多网络、IP地址、路由器构成。

Therefore， 整个互联网可以看成是众多自治系统的组合。每个自治系统对外表现出的是一个单一的和一致的路由选择协议。

AS之间的路由选择：域间路由 Intra-Domain, 使用外部网关协议
AS内部的路由选择：域内路由 Inter-Domain, 使用内部网关协议

### 内部网关协议 RIP
> 基于 Bellman-Ford 算法
路由信息协议

每个路由器维护一个到其它路由器的距离向量。

向量超过一定值时，相当于不可达。 

> 只适用于小型互联网

每一个路由器(who)和相邻路由器(when)按固定的时间间隔(what)交换全部本路由知道的信息。

存在的问题：网络出现故障时，需要较长的时间才能把信息传达到所有的路由器。

> 好消息传得快，坏消息传得慢

### 内部网关协议 OSPF
> 基于 Dijkstra 算法
Open Shortest Path First， 开放最短路径优先。

区别于 RIP 使用距离向量，OSPF使用链路状态协议：使用洪泛法，(who)向所有路由器发送信息，每个路由器再将信息发往其它路由器。(what)发送的信息是本结点相邻的所有路由器的链路状态，可能包括带宽、费用、时延，称之为“度量”或者“代价”。(when)类似是每隔一段时间发送。

每个路由器收到其它路由器的链路状态后，即可推知整个自治系统的拓扑状态，从而可以使用Dijkstra算法为本结点计算路由。

特点：更新过程收敛得快。

采用 OSPF 的自治系统可以再划分出区域，自治系统划分成主干区域和非主干区域。跨区域之间的路由可以先收集一个区域内所有的信息，然后再发往其它区域的边界路由器。

### 外部网关协议 BGP
Border Gateway Protocol: 边界网关协议

BGP发言人： 每个 AS 的管理员需要选择一个路由器作为speaker， 一般是 BGP边界路由器。  
不同AS的BGP speaker 建立 TCP 连接，交换BGP报文以建立BGP会话。

边界路由器之间需要建立 eBGP 连接，边界路由器和对应自治系统的内部路由器之间需要建立 iBGP 连接。它们都使用 TCP 连接。

AS内部的 iBGP 必须是全连通的（logically）， even thought it might not be connected physically.


